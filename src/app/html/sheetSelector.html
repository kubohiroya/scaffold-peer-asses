<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <base target="_top" />
    <?!= HtmlService.createHtmlOutputFromFile('sheetSelectorStyle').getContent(); ?>
</head>
<body>
<div id="app">
    <p style="text-align: center; margin-top: 50px" >{{message}}</p>

    <div
            v-if="initializing"
            class="text-center"
            style="text-align: center; margin-top: 50px; margin-left: auto; margin-right: auto; width: 100%"
    >
        <v-progress-circular
                indeterminate
                color="primary"
        ></v-progress-circular>
    </div>

    <div v-else
         class="text-center" style="display: flex; flex-direction: column; justify-content: center; align-items: center">
        <v-list dense>
            <v-subheader>{{spreadsheetName}}</v-subheader>
        </v-list>

        <v-list-item-group
                v-model="sheetId"
                color="primary"
        >
            <v-list-item
                    v-for="(sheet, sheetIndex) in sheets"
                    :key="sheet.getSheetName()"
            >
                <v-list-item-icon>
                    <v-icon :color="sheet.getTabColor()"></v-icon>
                </v-list-item-icon>
                <v-list-item-content>
                    <v-list-item-title>{{sheet.getSheetName()}}</v-list-item-title>
                </v-list-item-content>
            </v-list-item>
        </v-list-item-group>

        <v-btn large @click="submit" >
            選択(閉じる)
        </v-btn>
    </div>


</div>
<script type="text/javascript">
    const command = "<?= command ?>";
</script>
<?!= HtmlService.createHtmlOutputFromFile('sheetSelectorScript').getContent(); ?>
</body>
</html>
